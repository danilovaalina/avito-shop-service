# README

## Запуск приложения

Для запуска приложения выполните следующие шаги:

1. **Запуск с помощью Docker Compose:**
   Запустите контейнеры следующей командой:
   ```bash
   docker-compose up avito-shop-service, db
   ```
   Это запустит два основных сервиса:
   - `avito-shop-service` (приложение).
   - `db` (PostgreSQL).

2. **Настройка переменных окружения:**
   Приложение использует следующие переменные окружения для конфигурации работы сервера и подключения к базе данных:

    - `SERVER_PORT`: Порт, на котором будет запущен сервер. По умолчанию используется порт `8080`.
    - `DATABASE_USER`: Имя пользователя PostgreSQL. По умолчанию — `postgres`.
    - `DATABASE_PASSWORD`: Пароль пользователя PostgreSQL. По умолчанию — `postgres`.
    - `DATABASE_HOST`: Хост PostgreSQL. По умолчанию — `localhost`.
    - `DATABASE_PORT`: Порт PostgreSQL. По умолчанию — `5432`.
    - `DATABASE_NAME`: Название базы данных. По умолчанию — `shop`.

   По умолчанию путь к базе данных выглядит следующим образом:

   ```
   postgres://postgres:postgres@localhost:5432/shop?sslmode=disable
   ```
   
   Вы можете изменить эти параметры, создав файл `.env` в корне проекта или задав их через командную строку.

   В процессе запуска будет выполнен скрипт инициализации базы данных из файла `./scripts/init.sql`.

## Проблемы и их решения

### 1. Отображение истории операций
**Проблема:**  
Не было понятно, должна ли история операций отображать только переводы между пользователями или включать другие типы операций, такие как пополнение баланса при регистрации и покупка товаров.
Названия полей `toUser` и `fromUser` создавали неопределенность, так как некоторые операции (например, пополнение баланса или покупка товаров) не имеют явного отправителя или получателя.

**Решение:**  
Было решено сделать историю максимально полной и понятной. Для этого были созданы системные пользователи, которые участвуют в транзакциях для таких операций, как:
- Пополнение баланса при регистрации.
- Покупка товаров.

Это позволяет сохранять все операции с монетками в единой системе, где каждая транзакция имеет отправителя (`fromUser`) и получателя (`toUser`).

### 2. Необходимость микросервисов
**Проблема:**  
Не было четкого указания, требуется ли разделение на микросервисы. Особенно актуально это для авторизации, которая часто выделяется в отдельный сервис.

**Решение:**  
В текущей реализации авторизация интегрирована в основное приложение. Однако структура кода позволяет легко выделить ее в отдельный микросервис, если это станет необходимым в будущем.